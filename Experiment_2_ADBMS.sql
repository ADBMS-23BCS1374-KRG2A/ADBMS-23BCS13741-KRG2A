USE githubUpload;

CREATE TABLE VILLAGES (
  VILLAGE_ID INT PRIMARY KEY,
  VILLAGE_NAME VARCHAR(50)
);

CREATE TABLE DEPARTMENTS (
  DEPARTMENT_ID INT PRIMARY KEY,
  DEPARTMENT_NAME VARCHAR(50)
);

CREATE TABLE JUTSUS (
  JUTSU_ID INT PRIMARY KEY,
  JUTSU_NAME VARCHAR(50),
  VILLAGE_ID INT,
  DEPARTMENT_ID INT,
  FOREIGN KEY (VILLAGE_ID) REFERENCES VILLAGES(VILLAGE_ID),
  FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(DEPARTMENT_ID)
);

INSERT INTO VILLAGES (VILLAGE_ID, VILLAGE_NAME) VALUES
(1, 'KONOHA'),
(2, 'SUNAGAKURE'),
(3, 'KIRIGAKURE'),
(4, 'KUMOGAKURE'),
(5, 'IWAGAKURE');

INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME) VALUES
(1, 'NINJUTSU'),
(2, 'TAIJUTSU'),
(3, 'GENJUTSU'),
(4, 'MEDICAL'),
(5, 'DOUJUTSU'),
(6, 'SPACE-TIME');

INSERT INTO JUTSUS (JUTSU_ID, JUTSU_NAME, VILLAGE_ID, DEPARTMENT_ID) VALUES
(101, 'SHADOW CLONE JUTSU', 1, 1),
(102, 'RASENGAN', 1, 1),
(103, 'CHIDORI', 1, 1),
(104, 'FIRE STYLE: FIREBALL JUTSU', 1, 1),
(105, 'FLYING RAIJIN', 1, 6),
(106, 'RASENSHURIKEN', 1, 1),
(107, 'WOOD STYLE', 1, 1),
(108, '100 HEALINGS', 1, 4),
(201, 'SAND COFFIN', 2, 1),
(203, 'SAND ARMOR', 2, 1),
(301, 'WATER CLONE JUTSU', 3, 1),
(401, 'LIGHTNING BEAST JUTSU', 4, 1),
(402, 'RAIKIRI', 4, 1),
(403, 'KIRIN', 4, 1),
(503, 'SUSANOO', 5, 5);

SELECT V.VILLAGE_NAME
FROM VILLAGES V
JOIN JUTSUS J ON V.VILLAGE_ID = J.VILLAGE_ID
GROUP BY V.VILLAGE_NAME
HAVING COUNT(J.JUTSU_ID) > 2;
